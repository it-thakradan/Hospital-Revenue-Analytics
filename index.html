<!doctype html>
<html lang="th">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hospital Revenue Dashboard</title>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
        body {
            box-sizing: border-box;
            font-family: 'Prompt', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100%;
        }

        .dashboard-container {
            display: flex;
            min-height: 100%;
        }

        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border-right: 1px solid rgba(255, 255, 255, 0.18);
            padding: 20px 0;
            overflow-y: auto;
        }

        .logo {
            text-align: center;
            padding: 0 20px 30px;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
            margin-bottom: 20px;
        }

        .logo h1 {
            color: #4c63d2;
            font-size: 20px;
            font-weight: 600;
            margin: 0;
        }

        .logo p {
            color: #6b7280;
            font-size: 14px;
            margin: 5px 0 0;
        }

        .menu-item {
            margin: 0 15px 10px;
        }

        .menu-header {
            padding: 12px 15px;
            background: linear-gradient(135deg, #4c63d2, #667eea);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .menu-header:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(76, 99, 210, 0.4);
        }

        .menu-header.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .submenu {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 0 0 10px 10px;
            margin-top: -5px;
            padding: 10px 0;
            display: none;
            border: 1px solid rgba(102, 126, 234, 0.2);
            border-top: none;
        }

        .submenu.active {
            display: block;
        }

        .submenu-item {
            padding: 8px 20px;
            color: #4b5563;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .submenu-item:hover {
            background: rgba(102, 126, 234, 0.1);
            color: #4c63d2;
            padding-left: 25px;
        }

        .submenu-item.active {
            background: rgba(102, 126, 234, 0.15);
            color: #4c63d2;
            font-weight: 500;
        }

        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .content-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }

        .content-header h2 {
            color: #4c63d2;
            margin: 0 0 10px;
            font-size: 28px;
            font-weight: 600;
        }

        .content-header p {
            color: #6b7280;
            margin: 0;
            font-size: 16px;
        }

        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-group {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(31, 38, 135, 0.2);
        }

        .filter-group label {
            display: block;
            color: #4b5563;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .filter-group select {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 8px;
            background: white;
            color: #4b5563;
            font-family: 'Prompt', sans-serif;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .filter-group select:focus {
            outline: none;
            border-color: #4c63d2;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h3 {
            color: #4c63d2;
            margin: 0 0 15px;
            font-size: 18px;
            font-weight: 600;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            color: #6b7280;
            font-size: 14px;
        }

        .metric-value {
            color: #4c63d2;
            font-weight: 600;
            font-size: 16px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            margin-bottom: 20px;
        }

        .chart-container h3 {
            color: #4c63d2;
            margin: 0 0 20px;
            font-size: 20px;
            font-weight: 600;
        }

        .data-table {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            overflow-x: auto;
        }

        .data-table h3 {
            color: #4c63d2;
            margin: 0 0 20px;
            font-size: 20px;
            font-weight: 600;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th {
            background: linear-gradient(135deg, #4c63d2, #667eea);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 500;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
            color: #4b5563;
        }

        tr:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        .arrow {
            transition: transform 0.3s ease;
        }

        .arrow.rotated {
            transform: rotate(180deg);
        }

        .data-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(31, 38, 135, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.3);
            z-index: 1000;
            min-width: 350px;
            text-align: center;
            display: none;
            animation: popupFadeIn 0.3s ease-out;
        }

        .data-popup.show {
            display: block;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 999;
            display: none;
        }

        .popup-overlay.show {
            display: block;
        }

        .popup-header {
            color: #4c63d2;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .popup-year {
            color: #6b7280;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .popup-amount {
            color: #1f2937;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 25px;
            padding: 15px;
            background: linear-gradient(135deg, rgba(76, 99, 210, 0.1), rgba(102, 126, 234, 0.1));
            border-radius: 12px;
            border: 2px solid rgba(76, 99, 210, 0.2);
        }

        .popup-close {
            background: linear-gradient(135deg, #4c63d2, #667eea);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-family: 'Prompt', sans-serif;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .popup-close:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(76, 99, 210, 0.4);
        }

        @keyframes popupFadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        @media (max-width: 768px) {
            .dashboard-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .data-popup {
                min-width: 300px;
                margin: 20px;
                width: calc(100% - 40px);
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="dashboard-container">
   <nav class="sidebar">
    <div class="logo">
     <h1 id="hospital-name">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ó‡πà‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô</h1>
     <p id="dashboard-title">Dashboard ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</p>
    </div>
    <div class="menu-item">
     <div class="menu-header" onclick="toggleMenu('overview')"><span>Overview</span> <span class="arrow" id="overview-arrow">‚ñº</span>
     </div>
     <div class="submenu" id="overview-menu">
      <div class="submenu-item active" onclick="selectSubmenu(this, '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•')">
       ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
      </div>
     </div>
    </div>
    <div class="menu-item">
     <div class="menu-header" onclick="toggleMenu('income')"><span>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</span> <span class="arrow" id="income-arrow">‚ñº</span>
     </div>
     <div class="submenu" id="income-menu">
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤')">
       ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ')">
       ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£')">
       ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
      </div>
     </div>
    </div>
    <div class="menu-item">
     <div class="menu-header" onclick="toggleMenu('expenses')"><span>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</span> <span class="arrow" id="expenses-arrow">‚ñº</span>
     </div>
     <div class="submenu" id="expenses-menu">
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£')">
       ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏™‡∏≠‡∏¢ Maintainance ‡∏£‡∏∞‡∏ö‡∏ö')">
       ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏™‡∏≠‡∏¢ Maintainance ‡∏£‡∏∞‡∏ö‡∏ö
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ')">
       ‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå')">
       ‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ')">
       ‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô/‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£')">
       ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô/‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏ö‡∏¥‡∏Å‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô')">
       ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÉ‡∏´‡πâ ‡∏£‡∏û.‡∏™‡∏ï. ‡πÅ‡∏•‡∏∞ ‡∏™‡∏™‡∏≠.')">
       ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÉ‡∏´‡πâ ‡∏£‡∏û.‡∏™‡∏ï. ‡πÅ‡∏•‡∏∞ ‡∏™‡∏™‡∏≠.
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ')">
       ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
      </div>
      <div class="submenu-item" onclick="selectSubmenu(this, '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ')">
       ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ
      </div>
     </div>
    </div>
    <div class="menu-item">
     <div class="menu-header" onclick="toggleMenu('productivity')"><span>Productivity</span> <span class="arrow" id="productivity-arrow">‚ñº</span>
     </div>
     <div class="submenu" id="productivity-menu">
     </div>
    </div>
   </nav>
   <main class="main-content">
    <div class="content-header">
     <h2 id="current-section">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</h2>
     <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô</p>
    </div>
    <div class="filters" id="filters-container">
     <div class="filter-group"><label for="year-filter">‡∏õ‡∏µ</label> <select id="year-filter" onchange="updateData()"> <option value="all">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option> <option value="2568">2568</option> <option value="2567">2567</option> <option value="2566">2566</option> <option value="2565">2565</option> </select>
     </div>
     <div class="filter-group" id="department-filter-group" style="display: none;"><label for="department-filter">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label> <select id="department-filter" onchange="updateData()"> <option value="‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°">‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°</option> <option value="‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢">‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢</option> <option value="‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û">‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û</option> <option value="OP">OP</option> <option value="IP">IP</option> </select>
     </div>
     <div class="filter-group" id="rights-filter-group" style="display: none;"><label for="rights-filter">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥</label> <select id="rights-filter" onchange="updateData()"> <option value="UC">UC</option> <option value="‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£">‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</option> <option value="‡∏≠‡∏õ‡∏ó">‡∏≠‡∏õ‡∏ó</option> <option value="‡∏õ‡∏Å‡∏™">‡∏õ‡∏Å‡∏™</option> <option value="‡∏û‡∏£‡∏ö">‡∏û‡∏£‡∏ö</option> </select>
     </div>
    </div>
    <div class="dashboard-grid" id="metrics-grid">
     <div class="card">
      <h3>‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h3>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2565</span> <span class="metric-value">9,866,449.65 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2566</span> <span class="metric-value">12,128,216.38 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2567</span> <span class="metric-value">11,202,559.81 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2568</span> <span class="metric-value">5,621,160.91 ‡∏ö‡∏≤‡∏ó</span>
      </div>
     </div>
     <div class="card">
      <h3>‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏∞‡∏™‡∏° (‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)</h3>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2565</span> <span class="metric-value">1,883,518.87 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2566</span> <span class="metric-value">4,335,839.68 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2567</span> <span class="metric-value">10,500,593.50 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2568</span> <span class="metric-value">10,759,203.62 ‡∏ö‡∏≤‡∏ó</span>
      </div>
     </div>
     <div class="card">
      <h3>‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô</h3>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2565</span> <span class="metric-value">4,148,801.36 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2566</span> <span class="metric-value">5,046,204.04 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2567</span> <span class="metric-value">4,747,463.01 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2568</span> <span class="metric-value">6,199,498.52 ‡∏ö‡∏≤‡∏ó</span>
      </div>
     </div>
     <div class="card">
      <h3>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô (NET INCOME)</h3>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2565</span> <span class="metric-value" style="color: #ef4444;">-1,334,337.12 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2566</span> <span class="metric-value" style="color: #ef4444;">-568,838.75 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2567</span> <span class="metric-value" style="color: #10b981;">3,654,100.98 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2568</span> <span class="metric-value" style="color: #ef4444;">-1,313,807.82 ‡∏ö‡∏≤‡∏ó</span>
      </div>
     </div>
     <div class="card">
      <h3>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Current Ratio)</h3>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2565</span> <span class="metric-value">3.14</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2566</span> <span class="metric-value">3.50</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2567</span> <span class="metric-value">4.84</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2568</span> <span class="metric-value">2.79</span>
      </div>
     </div>
     <div class="card">
      <h3>Working Capital</h3>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2565</span> <span class="metric-value">8,878,634.38 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2566</span> <span class="metric-value">12,614,806.17 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2567</span> <span class="metric-value">18,212,923.60 ‡∏ö‡∏≤‡∏ó</span>
      </div>
      <div class="metric"><span class="metric-label">‡∏õ‡∏µ 2568</span> <span class="metric-value">11,123,611.54 ‡∏ö‡∏≤‡∏ó</span>
      </div>
     </div>
    </div>
    <div class="chart-container">
     <h3>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô 4 ‡∏õ‡∏µ</h3>
     <canvas id="revenueChart" width="400" height="200"></canvas>
    </div>
    <div class="data-table">
     <h3>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ó‡πà‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô</h3>
     <table id="data-table">
      <thead>
       <tr>
        <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
        <th>‡∏õ‡∏µ 2565</th>
        <th>‡∏õ‡∏µ 2566</th>
        <th>‡∏õ‡∏µ 2567</th>
        <th>‡∏õ‡∏µ 2568</th>
        <th>‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á (%)</th>
       </tr>
      </thead>
      <tbody id="table-body">
       <tr>
        <td>‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</td>
        <td>9,866,449.65</td>
        <td>12,128,216.38</td>
        <td>11,202,559.81</td>
        <td>5,621,160.91</td>
        <td style="color: #ef4444;">-49.8%</td>
       </tr>
       <tr>
        <td>‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô</td>
        <td>4,148,801.36</td>
        <td>5,046,204.04</td>
        <td>4,747,463.01</td>
        <td>6,199,498.52</td>
        <td style="color: #ef4444;">+30.6%</td>
       </tr>
       <tr>
        <td>‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏∞‡∏™‡∏° (‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)</td>
        <td>1,883,518.87</td>
        <td>4,335,839.68</td>
        <td>10,500,593.50</td>
        <td>10,759,203.62</td>
        <td style="color: #ef4444;">+2.5%</td>
       </tr>
       <tr>
        <td>‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô</td>
        <td>5,717,648.29</td>
        <td>7,082,012.34</td>
        <td>6,455,096.80</td>
        <td>-578,337.61</td>
        <td style="color: #ef4444;">-109.0%</td>
       </tr>
       <tr>
        <td>Current Ratio</td>
        <td>3.14</td>
        <td>3.50</td>
        <td>4.84</td>
        <td>2.79</td>
        <td style="color: #ef4444;">-42.4%</td>
       </tr>
       <tr>
        <td>Quick Ratio</td>
        <td>2.83</td>
        <td>3.26</td>
        <td>4.59</td>
        <td>2.64</td>
        <td style="color: #ef4444;">-42.5%</td>
       </tr>
       <tr>
        <td>Cash Ratio</td>
        <td>2.38</td>
        <td>2.40</td>
        <td>2.36</td>
        <td>0.91</td>
        <td style="color: #ef4444;">-61.4%</td>
       </tr>
       <tr>
        <td>NET INCOME</td>
        <td>-1,334,337.12</td>
        <td>-568,838.75</td>
        <td>3,654,100.98</td>
        <td>-1,313,807.82</td>
        <td style="color: #ef4444;">-136.0%</td>
       </tr>
       <tr>
        <td>Working Capital</td>
        <td>8,878,634.38</td>
        <td>12,614,806.17</td>
        <td>18,212,923.60</td>
        <td>11,123,611.54</td>
        <td style="color: #ef4444;">-38.9%</td>
       </tr>
      </tbody>
     </table>
    </div>
    <div class="data-table" style="margin-top: 20px;">
     <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ (‡∏õ‡∏µ 2568)</h3>
     <table>
      <thead>
       <tr>
        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</th>
        <th>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (%)</th>
        <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td>‡∏ô‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (‡∏£‡∏û.‡∏™‡∏ï.)</td>
        <td>7,164,565.87</td>
        <td style="color: #4c63d2; font-weight: 600;">66.59%</td>
        <td>‡∏ô‡∏≠‡∏Å‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</td>
       </tr>
       <tr>
        <td>‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£/‡∏≠‡∏õ‡∏ó/‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à</td>
        <td>1,437,496.50</td>
        <td style="color: #4c63d2; font-weight: 600;">13.36%</td>
        <td>-</td>
       </tr>
       <tr>
        <td>‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC</td>
        <td>1,021,978.25</td>
        <td style="color: #4c63d2; font-weight: 600;">9.50%</td>
        <td>-</td>
       </tr>
       <tr>
        <td>‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</td>
        <td>821,656.50</td>
        <td style="color: #4c63d2; font-weight: 600;">7.64%</td>
        <td>-</td>
       </tr>
       <tr>
        <td>‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
        <td>313,506.50</td>
        <td style="color: #4c63d2; font-weight: 600;">2.91%</td>
        <td>-</td>
       </tr>
       <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
        <td>‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
        <td>10,759,203.62</td>
        <td style="color: #4c63d2;">100.00%</td>
        <td>-</td>
       </tr>
      </tbody>
     </table>
    </div>
    <div class="data-table" style="margin-top: 20px;">
     <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏∞‡∏™‡∏° (‡∏õ‡∏µ 2568)</h3>
     <table>
      <thead>
       <tr>
        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</th>
        <th>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (%)</th>
        <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td>‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô</td>
        <td>1,286,163.75</td>
        <td style="color: #4c63d2; font-weight: 600;">20.75%</td>
        <td>‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô</td>
       </tr>
       <tr>
        <td>‡∏¢‡∏≤</td>
        <td>1,275,834.36</td>
        <td style="color: #4c63d2; font-weight: 600;">20.58%</td>
        <td>‡∏¢‡∏≤</td>
       </tr>
       <tr>
        <td>‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏ò.</td>
        <td>1,184,184.00</td>
        <td style="color: #4c63d2; font-weight: 600;">19.10%</td>
        <td>‡∏ô‡∏Ñ 1</td>
       </tr>
       <tr>
        <td>‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</td>
        <td>615,304.50</td>
        <td style="color: #4c63d2; font-weight: 600;">9.93%</td>
        <td>lab + ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</td>
       </tr>
       <tr>
        <td>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô</td>
        <td>661,795.26</td>
        <td style="color: #4c63d2; font-weight: 600;">10.68%</td>
        <td>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô</td>
       </tr>
       <tr>
        <td>‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤</td>
        <td>363,158.00</td>
        <td style="color: #4c63d2; font-weight: 600;">5.86%</td>
        <td>‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏ù‡∏≤‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</td>
       </tr>
       <tr>
        <td>‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</td>
        <td>296,386.98</td>
        <td style="color: #4c63d2; font-weight: 600;">4.78%</td>
        <td>lab + ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</td>
       </tr>
       <tr>
        <td>‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏∑‡πà‡∏ô</td>
        <td>270,232.70</td>
        <td style="color: #4c63d2; font-weight: 600;">4.36%</td>
        <td>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô</td>
       </tr>
       <tr>
        <td>‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∏‡∏õ‡πÇ‡∏†‡∏Ñ</td>
        <td>122,587.38</td>
        <td style="color: #4c63d2; font-weight: 600;">1.98%</td>
        <td>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô</td>
       </tr>
       <tr>
        <td>‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</td>
        <td>110,200.00</td>
        <td style="color: #4c63d2; font-weight: 600;">1.78%</td>
        <td>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô</td>
       </tr>
       <tr>
        <td>‡∏†‡∏≤‡∏©‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢</td>
        <td>13,651.59</td>
        <td style="color: #4c63d2; font-weight: 600;">0.22%</td>
        <td>‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏ù‡∏≤‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</td>
       </tr>
       <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
        <td>‡∏£‡∏ß‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
        <td>6,199,498.52</td>
        <td style="color: #4c63d2;">100.00%</td>
        <td>-</td>
       </tr>
      </tbody>
     </table>
    </div>
   </main>
  </div><!-- Data Popup -->
  <div class="popup-overlay" id="popup-overlay" onclick="closeDataPopup()"></div>
  <div class="data-popup" id="data-popup">
   <div class="popup-header" id="popup-header"></div>
   <div class="popup-year" id="popup-year"></div>
   <div class="popup-amount" id="popup-amount"></div><button class="popup-close" onclick="closeDataPopup()">‡∏õ‡∏¥‡∏î</button>
  </div>
  <script>
        const defaultConfig = {
            hospital_name: "‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ó‡πà‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô",
            dashboard_title: "Dashboard ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ",
            primary_color: "#4c63d2",
            secondary_color: "#667eea",
            background_color: "#f8fafc",
            text_color: "#1f2937",
            accent_color: "#10b981"
        };

        let currentSection = '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•';
        let revenueChart;

        // Popup functions
        function showDataPopup(datasetLabel, year, amount) {
            document.getElementById('popup-header').textContent = datasetLabel.replace(' (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)', '');
            document.getElementById('popup-year').textContent = `‡∏õ‡∏µ ${year}`;
            document.getElementById('popup-amount').textContent = amount;
            
            document.getElementById('popup-overlay').classList.add('show');
            document.getElementById('data-popup').classList.add('show');
        }

        function closeDataPopup() {
            document.getElementById('popup-overlay').classList.remove('show');
            document.getElementById('data-popup').classList.remove('show');
        }

        // Close popup when pressing Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeDataPopup();
            }
        });

        // Chart data mapping for popup display
        const chartDataMapping = {
            '‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '9,866,449.65 ‡∏ö‡∏≤‡∏ó',
                '2566': '12,128,216.38 ‡∏ö‡∏≤‡∏ó',
                '2567': '11,202,559.81 ‡∏ö‡∏≤‡∏ó',
                '2568': '5,621,160.91 ‡∏ö‡∏≤‡∏ó'
            },
            '‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '4,148,801.36 ‡∏ö‡∏≤‡∏ó',
                '2566': '5,046,204.04 ‡∏ö‡∏≤‡∏ó',
                '2567': '4,747,463.01 ‡∏ö‡∏≤‡∏ó',
                '2568': '6,199,498.52 ‡∏ö‡∏≤‡∏ó'
            },
            '‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏∞‡∏™‡∏° (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '1,883,518.87 ‡∏ö‡∏≤‡∏ó',
                '2566': '4,335,839.68 ‡∏ö‡∏≤‡∏ó',
                '2567': '10,500,593.50 ‡∏ö‡∏≤‡∏ó',
                '2568': '10,759,203.62 ‡∏ö‡∏≤‡∏ó'
            },
            'Working Capital (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '8,878,634.38 ‡∏ö‡∏≤‡∏ó',
                '2566': '12,614,806.17 ‡∏ö‡∏≤‡∏ó',
                '2567': '18,212,923.60 ‡∏ö‡∏≤‡∏ó',
                '2568': '11,123,611.54 ‡∏ö‡∏≤‡∏ó'
            }
        };

        // Initialize chart
        function initChart() {
            const ctx = document.getElementById('revenueChart').getContext('2d');
            revenueChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['2565', '2566', '2567', '2568'],
                    datasets: [
                        {
                            label: '‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [9.87, 12.13, 11.20, 5.62],
                            borderColor: '#4c63d2',
                            backgroundColor: '#4c63d2' + '20',
                            tension: 0.4,
                            fill: false
                        },
                        {
                            label: '‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [4.15, 5.05, 4.75, 6.20],
                            borderColor: '#ef4444',
                            backgroundColor: '#ef4444' + '20',
                            tension: 0.4,
                            fill: false
                        },
                        {
                            label: '‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏∞‡∏™‡∏° (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [1.88, 4.34, 10.50, 10.76],
                            borderColor: '#f59e0b',
                            backgroundColor: '#f59e0b' + '20',
                            tension: 0.4,
                            fill: false
                        },
                        {
                            label: 'Working Capital (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [8.88, 12.61, 18.21, 11.12],
                            borderColor: '#10b981',
                            backgroundColor: '#10b981' + '20',
                            tension: 0.4,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        }
                    },
                    onClick: (event, elements) => {
                        if (elements.length > 0) {
                            const element = elements[0];
                            const datasetIndex = element.datasetIndex;
                            const dataIndex = element.index;
                            
                            const dataset = revenueChart.data.datasets[datasetIndex];
                            const year = revenueChart.data.labels[dataIndex];
                            const datasetLabel = dataset.label;
                            
                            const fullAmount = chartDataMapping[datasetLabel][year];
                            
                            showDataPopup(datasetLabel, year, fullAmount);
                        }
                    }
                }
            });
        }

        function toggleMenu(menuId) {
            const menu = document.getElementById(menuId + '-menu');
            const arrow = document.getElementById(menuId + '-arrow');
            const header = arrow.parentElement;
            
            // Close other menus
            document.querySelectorAll('.submenu').forEach(submenu => {
                if (submenu.id !== menuId + '-menu') {
                    submenu.classList.remove('active');
                }
            });
            
            document.querySelectorAll('.arrow').forEach(arr => {
                if (arr.id !== menuId + '-arrow') {
                    arr.classList.remove('rotated');
                }
            });
            
            document.querySelectorAll('.menu-header').forEach(h => {
                if (h !== header) {
                    h.classList.remove('active');
                }
            });
            
            // Toggle current menu
            menu.classList.toggle('active');
            arrow.classList.toggle('rotated');
            header.classList.toggle('active');
        }

        function selectSubmenu(element, sectionName) {
    // Remove active class from all submenu items
    document.querySelectorAll('.submenu-item').forEach(item => {
        item.classList.remove('active');
    });
    
    // Add active class to clicked item
    element.classList.add('active');
    
    // Update current section
    currentSection = sectionName;
    document.getElementById('current-section').textContent = sectionName;
    
    // Show/hide filters based on section
    updateFiltersVisibility(sectionName);

    // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤
    const expensesMenus = [
        '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£',
        '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏™‡∏≠‡∏¢ Maintainance ‡∏£‡∏∞‡∏ö‡∏ö',
        '‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ',
        '‡∏Ñ‡πà‡∏≤‡∏¢‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå',
        '‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
        '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô/‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£',
        '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô',
        '‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡πÉ‡∏´‡πâ ‡∏£‡∏û.‡∏™‡∏ï. ‡πÅ‡∏•‡∏∞ ‡∏™‡∏™‡∏≠.',
        '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ',
        '‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ'
    ];

    if (expensesMenus.includes(sectionName)) {
        // üîπ ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á
        document.getElementById('filters-container').style.display = 'none';  // ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        document.getElementById('metrics-grid').innerHTML = '<div style="padding:60px; text-align:center; color:#6b7280;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</div>';
        document.querySelectorAll('.data-table').forEach(table => table.style.display = 'none');
        document.querySelector('.chart-container').style.display = 'none';
        return; // ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å updateData()
    }

    // Update data display based on section
    if (sectionName === '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤') {
        showRevenueRightsData();
    } else if (sectionName === '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
        showOtherIncomeData();
    } else if (sectionName === '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£') {
        showOperatingIncomeData();
    } else {
        updateData();
    }
}



        function updateFiltersVisibility(sectionName) {
            const departmentFilter = document.getElementById('department-filter-group');
            const rightsFilter = document.getElementById('rights-filter-group');
            
            // Show department and rights filters for ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö, ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢, and Productivity sections
            const showFilters = ['‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö', '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢', 'Productivity'].some(section => 
                sectionName.includes(section) || 
                ['‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°', '‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢', '‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û', 'OP', 'IP'].includes(sectionName) ||
                sectionName.includes('‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏Å‡πá‡∏ö') ||
                sectionName.includes('PP fee')
            );
            
            departmentFilter.style.display = showFilters ? 'block' : 'none';
            rightsFilter.style.display = showFilters ? 'block' : 'none';
        }

        // Real data for each year
        const yearlyData = {
            '2565': {
                maintenance_fund: 9866449.65,
                debt: 4148801.36,
                receivables: 1883518.87,
                net_fund: 5717648.29,
                current_ratio: 3.14,
                quick_ratio: 2.83,
                cash_ratio: 2.38,
                net_income: -1334337.12,
                working_capital: 8878634.38,
                revenue_rights: {
                    '‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô UC': 45250000.50,
                    '‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC (‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢)': 12850000.25,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£': 8950000.75,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à': 3250000.50,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏≠‡∏õ‡∏ó.': 6750000.25,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': 15450000.80,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC': 58100000.75,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡∏ï‡∏£‡∏á': 18950000.50,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': 15450000.80
                },
                other_income: {
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': 8450325.75,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô': 3250150.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ': 1850450.00,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 950275.50,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 14501201.50
                },
                operating_income: {
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•': 2850000.50,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå': 1950000.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°': 850000.75,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢': 650000.50,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î': 450000.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 1694324.50,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': 8450325.75
                },
                receivables_detail: {
                    '‡∏ô‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (‡∏£‡∏û.‡∏™‡∏ï.)': { amount: 1200000.50, percent: 63.71 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£/‡∏≠‡∏õ‡∏ó/‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à': { amount: 280000.25, percent: 14.87 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC': { amount: 195000.12, percent: 10.35 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': { amount: 150000.00, percent: 7.96 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': { amount: 58518.00, percent: 3.11 }
                },
                debt_detail: {
                    '‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô': { amount: 850000.25, percent: 20.49 },
                    '‡∏¢‡∏≤': { amount: 820000.50, percent: 19.77 },
                    '‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏ò.': { amount: 780000.00, percent: 18.81 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå': { amount: 400000.15, percent: 9.64 },
                    '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô': { amount: 450000.30, percent: 10.85 },
                    '‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤': { amount: 250000.00, percent: 6.03 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå': { amount: 200000.25, percent: 4.82 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏∑‡πà‡∏ô': { amount: 180000.50, percent: 4.34 },
                    '‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∏‡∏õ‡πÇ‡∏†‡∏Ñ': { amount: 95000.75, percent: 2.29 },
                    '‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå': { amount: 85000.00, percent: 2.05 },
                    '‡∏†‡∏≤‡∏©‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢': { amount: 37800.46, percent: 0.91 }
                }
            },
            '2566': {
                maintenance_fund: 12128216.38,
                debt: 5046204.04,
                receivables: 4335839.68,
                net_fund: 7082012.34,
                current_ratio: 3.50,
                quick_ratio: 3.26,
                cash_ratio: 2.40,
                net_income: -568838.75,
                working_capital: 12614806.17,
                revenue_rights: {
                    '‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô UC': 48750000.75,
                    '‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC (‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢)': 14250000.50,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£': 9850000.25,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à': 3650000.75,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏≠‡∏õ‡∏ó.': 7250000.50,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': 16850000.25,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC': 63000001.25,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡∏ï‡∏£‡∏á': 20750001.50,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': 16850000.25
                },
                other_income: {
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': 9125486.50,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô': 4180275.75,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ': 2125680.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 1125890.75,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 16557333.25
                },
                operating_income: {
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•': 3250000.75,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå': 2150000.50,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°': 950000.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢': 750000.75,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î': 525000.50,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 1499484.75,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': 9125486.50
                },
                receivables_detail: {
                    '‡∏ô‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (‡∏£‡∏û.‡∏™‡∏ï.)': { amount: 2850000.75, percent: 65.73 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£/‡∏≠‡∏õ‡∏ó/‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à': { amount: 620000.50, percent: 14.30 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC': { amount: 425000.25, percent: 9.80 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': { amount: 320000.18, percent: 7.38 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': { amount: 120839.00, percent: 2.79 }
                },
                debt_detail: {
                    '‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô': { amount: 1050000.50, percent: 20.81 },
                    '‡∏¢‡∏≤': { amount: 1020000.75, percent: 20.21 },
                    '‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏ò.': { amount: 950000.25, percent: 18.83 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå': { amount: 520000.30, percent: 10.31 },
                    '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô': { amount: 480000.50, percent: 9.51 },
                    '‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤': { amount: 320000.00, percent: 6.34 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå': { amount: 250000.75, percent: 4.95 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏∑‡πà‡∏ô': { amount: 220000.25, percent: 4.36 },
                    '‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∏‡∏õ‡πÇ‡∏†‡∏Ñ': { amount: 110000.50, percent: 2.18 },
                    '‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå': { amount: 95000.00, percent: 1.88 },
                    '‡∏†‡∏≤‡∏©‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢': { amount: 30201.98, percent: 0.60 }
                }
            },
            '2567': {
                maintenance_fund: 11202559.81,
                debt: 4747463.01,
                receivables: 10500593.50,
                net_fund: 6455096.80,
                current_ratio: 4.84,
                quick_ratio: 4.59,
                cash_ratio: 2.36,
                net_income: 3654100.98,
                working_capital: 18212923.60,
                revenue_rights: {
                    '‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô UC': 52450000.25,
                    '‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC (‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢)': 15850000.75,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£': 10750000.50,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à': 4150000.25,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏≠‡∏õ‡∏ó.': 8250000.75,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': 18450000.50,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC': 68300001.00,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡∏ï‡∏£‡∏á': 23150001.50,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': 18450000.50
                },
                other_income: {
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': 10875642.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô': 5420890.50,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ': 2650920.75,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 1480650.25,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 20428103.75
                },
                operating_income: {
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•': 3850000.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå': 2650000.75,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°': 1150000.50,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢': 925000.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î': 675000.75,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 1624640.75,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': 10875642.25
                },
                receivables_detail: {
                    '‡∏ô‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (‡∏£‡∏û.‡∏™‡∏ï.)': { amount: 6950000.25, percent: 66.19 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£/‡∏≠‡∏õ‡∏ó/‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à': { amount: 1420000.75, percent: 13.52 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC': { amount: 1050000.50, percent: 10.00 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': { amount: 780000.00, percent: 7.43 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': { amount: 300593.00, percent: 2.86 }
                },
                debt_detail: {
                    '‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô': { amount: 980000.75, percent: 20.64 },
                    '‡∏¢‡∏≤': { amount: 950000.50, percent: 20.01 },
                    '‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏ò.': { amount: 890000.25, percent: 18.75 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå': { amount: 480000.50, percent: 10.11 },
                    '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô': { amount: 450000.75, percent: 9.48 },
                    '‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤': { amount: 300000.00, percent: 6.32 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå': { amount: 240000.25, percent: 5.05 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏∑‡πà‡∏ô': { amount: 210000.50, percent: 4.42 },
                    '‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∏‡∏õ‡πÇ‡∏†‡∏Ñ': { amount: 105000.75, percent: 2.21 },
                    '‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå': { amount: 90000.00, percent: 1.90 },
                    '‡∏†‡∏≤‡∏©‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢': { amount: 51460.26, percent: 1.08 }
                }
            },
            '2568': {
                maintenance_fund: 5621160.91,
                debt: 6199498.52,
                receivables: 10759203.62,
                net_fund: -578337.61,
                current_ratio: 2.79,
                quick_ratio: 2.64,
                cash_ratio: 0.91,
                net_income: -1313807.82,
                working_capital: 11123611.54,
                revenue_rights: {
                    '‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô UC': 49850000.50,
                    '‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC (‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢)': 14650000.25,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£': 9950000.75,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à': 3850000.50,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏≠‡∏õ‡∏ó.': 7650000.25,
                    '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': 17250000.75,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC': 64500000.75,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡∏ï‡∏£‡∏á': 21450001.50,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': 17250000.75
                },
                other_income: {
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': 9650789.80,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô': 4875320.40,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ': 2280540.60,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 1320485.90,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 18127136.70
                },
                operating_income: {
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•': 3450000.50,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå': 2350000.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°': 1050000.75,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢': 825000.50,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏ö‡∏≥‡∏ö‡∏±‡∏î': 595000.25,
                    '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ': 1379788.55,
                    '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£': 9650789.80
                },
                receivables_detail: {
                    '‡∏ô‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (‡∏£‡∏û.‡∏™‡∏ï.)': { amount: 7164565.87, percent: 66.59 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£/‡∏≠‡∏õ‡∏ó/‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à': { amount: 1437496.50, percent: 13.36 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC': { amount: 1021978.25, percent: 9.50 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°': { amount: 821656.50, percent: 7.64 },
                    '‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ': { amount: 313506.50, percent: 2.91 }
                },
                debt_detail: {
                    '‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô': { amount: 1286163.75, percent: 20.75 },
                    '‡∏¢‡∏≤': { amount: 1275834.36, percent: 20.58 },
                    '‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏ò.': { amount: 1184184.00, percent: 19.10 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå': { amount: 615304.50, percent: 9.93 },
                    '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô': { amount: 661795.26, percent: 10.68 },
                    '‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤': { amount: 363158.00, percent: 5.86 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå': { amount: 296386.98, percent: 4.78 },
                    '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏≠‡∏∑‡πà‡∏ô': { amount: 270232.70, percent: 4.36 },
                    '‡∏Ñ‡πà‡∏≤‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∏‡∏õ‡πÇ‡∏†‡∏Ñ': { amount: 122587.38, percent: 1.98 },
                    '‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå': { amount: 110200.00, percent: 1.78 },
                    '‡∏†‡∏≤‡∏©‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢': { amount: 13651.59, percent: 0.22 }
                }
            }
        };

        function updateData() {
            // Show filters for non-revenue rights sections
            document.getElementById('filters-container').style.display = 'flex';
            
            // Show all tables for non-revenue rights sections
            const allTables = document.querySelectorAll('.data-table');
            allTables.forEach(table => table.style.display = 'block');
            
            const year = document.getElementById('year-filter').value;
            const department = document.getElementById('department-filter').value;
            const rights = document.getElementById('rights-filter').value;
            
            // Update metrics based on selected year
            updateMetrics(year);
            
            // Update chart data based on filters
            updateChartData(year, department, rights);
            
            // Update detail tables based on selected year
            updateDetailTables(year);
            
            // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡πÄ‡∏™‡∏°‡∏≠ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï
        }

        function updateChartData(year, department, rights) {
            // Sample data update based on filters
            let newData = [98.45, 105.23, 118.23, 125.45];
            
            if (department === '‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°') {
                newData = [8.2, 9.1, 10.5, 11.8];
            } else if (department === '‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢') {
                newData = [5.4, 6.2, 7.1, 8.3];
            }
            
            if (revenueChart) {
                revenueChart.data.datasets[0].data = newData;
                revenueChart.update();
            }
        }

        function showRevenueRightsData() {
            // Hide filters for this section
            document.getElementById('filters-container').style.display = 'none';
            
            // Update metrics to show revenue rights summary
            const metricsGrid = document.getElementById('metrics-grid');
            metricsGrid.innerHTML = `
                <div class="card">
                    <h3>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">13,633,748.04 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">18,192,965.95 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">14,237,290.73 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">7,478,413.25 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏î‡πâ</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">2,569,162.16 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">3,399,882.53 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">4,481,831.15 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">4,028,623.61 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">915,305.62 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">1,272,438.11 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">1,816,948.83 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">1,872,946.62 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">17,118,215.82 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">22,865,286.59 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">20,536,070.71 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">13,379,983.48 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ô‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô</h3>
                    <div class="metric">
                        <span class="metric-label">2566 ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 2565</span>
                        <span class="metric-value" style="color: #10b981;">+8.76%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">2567 ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 2566</span>
                        <span class="metric-value" style="color: #10b981;">+9.24%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">2568 ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 2567</span>
                        <span class="metric-value" style="color: #ef4444;">-6.09%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 4 ‡∏õ‡∏µ</span>
                        <span class="metric-value" style="color: #4c63d2;">+3.97%</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>
                        <span class="metric-value" style="color: #10b981;">2567 (+9.24%)</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏•‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span>
                        <span class="metric-value" style="color: #ef4444;">2568 (-6.09%)</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ‡∏ê‡∏≤‡∏ô</span>
                        <span class="metric-value">2565</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏£‡∏ß‡∏° 4 ‡∏õ‡∏µ</span>
                        <span class="metric-value" style="color: #10b981;">+11.57%</span>
                    </div>
                </div>
            `;

            // Update chart for revenue rights
            updateRevenueRightsChart();
            
            // Show revenue rights table
            showRevenueRightsTable();
        }

        // Revenue rights chart data mapping for popup display
        const revenueRightsDataMapping = {
            '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '13,633,748.04 ‡∏ö‡∏≤‡∏ó',
                '2566': '18,192,965.95 ‡∏ö‡∏≤‡∏ó',
                '2567': '14,237,290.73 ‡∏ö‡∏≤‡∏ó',
                '2568': '7,478,413.25 ‡∏ö‡∏≤‡∏ó'
            },
            '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏î‡πâ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '2,569,162.16 ‡∏ö‡∏≤‡∏ó',
                '2566': '3,399,882.53 ‡∏ö‡∏≤‡∏ó',
                '2567': '4,481,831.15 ‡∏ö‡∏≤‡∏ó',
                '2568': '4,028,623.61 ‡∏ö‡∏≤‡∏ó'
            },
            '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏° (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '915,305.62 ‡∏ö‡∏≤‡∏ó',
                '2566': '1,272,438.11 ‡∏ö‡∏≤‡∏ó',
                '2567': '1,816,948.83 ‡∏ö‡∏≤‡∏ó',
                '2568': '1,872,946.62 ‡∏ö‡∏≤‡∏ó'
            }
        };

        // Other income chart data mapping for popup display
        const otherIncomeDataMapping = {
            '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ COVID-19 (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '11,528,384.22 ‡∏ö‡∏≤‡∏ó',
                '2566': '4,369,070.43 ‡∏ö‡∏≤‡∏ó',
                '2567': '0.00 ‡∏ö‡∏≤‡∏ó',
                '2568': '0.00 ‡∏ö‡∏≤‡∏ó'
            },
            '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏≠‡∏á (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '1,411,446.00 ‡∏ö‡∏≤‡∏ó',
                '2566': '1,466,069.50 ‡∏ö‡∏≤‡∏ó',
                '2567': '1,630,536.75 ‡∏ö‡∏≤‡∏ó',
                '2568': '1,566,850.25 ‡∏ö‡∏≤‡∏ó'
            },
            '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '1,108,073.92 ‡∏ö‡∏≤‡∏ó',
                '2566': '1,084,676.49 ‡∏ö‡∏≤‡∏ó',
                '2567': '1,676,757.70 ‡∏ö‡∏≤‡∏ó',
                '2568': '1,718,537.01 ‡∏ö‡∏≤‡∏ó'
            },
            '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '741,500.32 ‡∏ö‡∏≤‡∏ó',
                '2566': '709,948.59 ‡∏ö‡∏≤‡∏ó',
                '2567': '494,061.20 ‡∏ö‡∏≤‡∏ó',
                '2568': '842,660.07 ‡∏ö‡∏≤‡∏ó'
            }
        };

        // Operating income chart data mapping for popup display
        const operatingIncomeDataMapping = {
            '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '31,907,620.28 ‡∏ö‡∏≤‡∏ó',
                '2566': '30,495,051.60 ‡∏ö‡∏≤‡∏ó',
                '2567': '24,337,426.36 ‡∏ö‡∏≤‡∏ó',
                '2568': '17,508,030.81 ‡∏ö‡∏≤‡∏ó'
            },
            'CF (UC IP + UC OP + UC PP) (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '1,050,027.98 ‡∏ö‡∏≤‡∏ó',
                '2566': '4,407,450.00 ‡∏ö‡∏≤‡∏ó',
                '2567': '2,657,128.00 ‡∏ö‡∏≤‡∏ó',
                '2568': '500,000.00 ‡∏ö‡∏≤‡∏ó'
            },
            '‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '78,420.00 ‡∏ö‡∏≤‡∏ó',
                '2566': '2,055,000.00 ‡∏ö‡∏≤‡∏ó',
                '2567': '1,150,000.00 ‡∏ö‡∏≤‡∏ó',
                '2568': '2,934,000.00 ‡∏ö‡∏≤‡∏ó'
            },
            '‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)': {
                '2565': '535,010.00 ‡∏ö‡∏≤‡∏ó',
                '2566': '1,423,500.00 ‡∏ö‡∏≤‡∏ó',
                '2567': '632,001.00 ‡∏ö‡∏≤‡∏ó',
                '2568': '178,875.00 ‡∏ö‡∏≤‡∏ó'
            }
        };

        function updateRevenueRightsChart() {
            if (revenueChart) {
                revenueChart.destroy();
            }
            
            const ctx = document.getElementById('revenueChart').getContext('2d');
            revenueChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['2565', '2566', '2567', '2568'],
                    datasets: [
                        {
                            label: '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [13.63, 18.19, 14.24, 7.48],
                            backgroundColor: '#4c63d2',
                            borderColor: '#4c63d2',
                            borderWidth: 1
                        },
                        {
                            label: '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏î‡πâ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [2.57, 3.40, 4.48, 4.03],
                            backgroundColor: '#10b981',
                            borderColor: '#10b981',
                            borderWidth: 1
                        },
                        {
                            label: '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏° (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [0.92, 1.27, 1.82, 1.87],
                            backgroundColor: '#f59e0b',
                            borderColor: '#f59e0b',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        }
                    },
                    onClick: (event, elements) => {
                        if (elements.length > 0) {
                            const element = elements[0];
                            const datasetIndex = element.datasetIndex;
                            const dataIndex = element.index;
                            
                            const dataset = revenueChart.data.datasets[datasetIndex];
                            const year = revenueChart.data.labels[dataIndex];
                            const datasetLabel = dataset.label;
                            
                            const fullAmount = revenueRightsDataMapping[datasetLabel][year];
                            
                            showDataPopup(datasetLabel, year, fullAmount);
                        }
                    }
                }
            });
        }

        function showRevenueRightsTable() {
            // Replace existing tables with revenue rights table
            const chartContainer = document.querySelector('.chart-container');
            chartContainer.innerHTML = `
                <h3>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤ 4 ‡∏õ‡∏µ</h3>
                <canvas id="revenueChart" width="400" height="200"></canvas>
            `;
            
            const dataTableContainer = document.querySelector('.data-table');
            dataTableContainer.innerHTML = `
                <h3>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤</h3>
                <table>
                    <thead>
                        <tr>
                            <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏µ 2565</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏µ 2566</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏µ 2567</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏µ 2568</th>
                            <th>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ô‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td></td>
                            <td style="font-weight: 600;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">UC</td>
                            <td style="padding-left: 20px;">‡πÄ‡∏á‡∏¥‡∏ô UC</td>
                            <td>13,630,093.04</td>
                            <td>18,191,385.95</td>
                            <td>14,233,395.73</td>
                            <td>7,141,119.39</td>
                            <td style="color: #ef4444;">-49.83%</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td style="padding-left: 20px;">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC (‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢)</td>
                            <td>3,655.00</td>
                            <td>1,580.00</td>
                            <td>3,895.00</td>
                            <td>337,293.86</td>
                            <td style="color: #10b981;">+8559.66%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td></td>
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC</td>
                            <td>13,633,748.04</td>
                            <td>18,192,965.95</td>
                            <td>14,237,290.73</td>
                            <td>7,478,413.25</td>
                            <td style="color: #ef4444;">-47.47%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡πÄ‡∏ö‡∏¥‡∏Å‡∏ï‡∏£‡∏á</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</td>
                            <td>2,132,354.94</td>
                            <td>3,149,452.39</td>
                            <td>4,026,453.66</td>
                            <td>3,303,286.03</td>
                            <td style="color: #ef4444;">-17.96%</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à</td>
                            <td>282,145.00</td>
                            <td>44,127.00</td>
                            <td>104,959.00</td>
                            <td>77,144.75</td>
                            <td style="color: #ef4444;">-26.50%</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏≠‡∏õ‡∏ó.</td>
                            <td>154,662.22</td>
                            <td>206,303.14</td>
                            <td>350,418.49</td>
                            <td>648,192.83</td>
                            <td style="color: #10b981;">+84.98%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td></td>
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏î‡πâ</td>
                            <td>2,569,162.16</td>
                            <td>3,399,882.53</td>
                            <td>4,481,831.15</td>
                            <td>4,028,623.61</td>
                            <td style="color: #ef4444;">-10.11%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</td>
                            <td>915,305.62</td>
                            <td>1,272,438.11</td>
                            <td>1,816,948.83</td>
                            <td>1,872,946.62</td>
                            <td style="color: #10b981;">+3.08%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td></td>
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</td>
                            <td>915,305.62</td>
                            <td>1,272,438.11</td>
                            <td>1,816,948.83</td>
                            <td>1,872,946.62</td>
                            <td style="color: #10b981;">+3.08%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.15); font-weight: 700; color: #4c63d2;">
                            <td></td>
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                            <td>17,118,215.82</td>
                            <td>22,865,286.59</td>
                            <td>20,536,070.71</td>
                            <td>13,379,983.48</td>
                            <td style="color: #ef4444;">-34.85%</td>
                        </tr>
                    </tbody>
                </table>
            `;

            // Add the detailed revenue rights table after the main table
            const mainContent = document.querySelector('.main-content');
            const existingDetailedTable = document.getElementById('detailed-revenue-rights-table');
            if (existingDetailedTable) {
                existingDetailedTable.remove();
            }

            const detailedTable = document.createElement('div');
            detailedTable.id = 'detailed-revenue-rights-table';
            detailedTable.className = 'data-table';
            detailedTable.style.marginTop = '20px';
            detailedTable.innerHTML = `
                <h3>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤ - ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏° 4 ‡∏õ‡∏µ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 65</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 66</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 67</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 68</th>
                            <th>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ô‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td></td>
                            <td style="font-weight: 600; color: #4c63d2;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td rowspan="3" style="text-align: center; font-weight: 600; color: #4c63d2; vertical-align: middle; background: rgba(76, 99, 210, 0.1);">UC</td>
                            <td style="padding-left: 20px;">‡πÄ‡∏á‡∏¥‡∏ô UC</td>
                            <td>13,630,093.04</td>
                            <td>18,191,385.95</td>
                            <td>14,233,395.73</td>
                            <td>7,141,119.39</td>
                            <td style="color: #ef4444; font-weight: 600;">-49.83%</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC (‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢)</td>
                            <td>3,655.00</td>
                            <td>1,580.00</td>
                            <td>3,895.00</td>
                            <td>337,293.86</td>
                            <td style="color: #10b981; font-weight: 600;">8559.66%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ UC</td>
                            <td>13,633,748.04</td>
                            <td>18,192,965.95</td>
                            <td>14,237,290.73</td>
                            <td>7,478,413.25</td>
                            <td style="color: #ef4444;">-47.47%</td>
                        </tr>
                        <tr>
                            <td rowspan="4" style="text-align: center; font-weight: 600; color: #4c63d2; vertical-align: middle; background: rgba(76, 99, 210, 0.1);">‡πÄ‡∏ö‡∏¥‡∏Å‡∏ï‡∏£‡∏á</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£</td>
                            <td>2,132,354.94</td>
                            <td>3,149,452.39</td>
                            <td>4,026,453.66</td>
                            <td>3,303,286.03</td>
                            <td style="color: #ef4444; font-weight: 600;">-17.96%</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ê‡∏ß‡∏¥‡∏™‡∏≤‡∏´‡∏Å‡∏¥‡∏à</td>
                            <td>282,145.00</td>
                            <td>44,127.00</td>
                            <td>104,959.00</td>
                            <td>77,144.75</td>
                            <td style="color: #ef4444; font-weight: 600;">-26.50%</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏≠‡∏õ‡∏ó.</td>
                            <td>154,662.22</td>
                            <td>206,303.14</td>
                            <td>350,418.49</td>
                            <td>648,192.83</td>
                            <td style="color: #10b981; font-weight: 600;">84.98%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏ö‡∏¥‡∏Å‡πÑ‡∏î‡πâ</td>
                            <td>2,569,162.16</td>
                            <td>3,399,882.53</td>
                            <td>4,481,831.15</td>
                            <td>4,028,623.61</td>
                            <td style="color: #ef4444;">-10.11%</td>
                        </tr>
                        <tr>
                            <td rowspan="2" style="text-align: center; font-weight: 600; color: #4c63d2; vertical-align: middle; background: rgba(76, 99, 210, 0.1);">‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</td>
                            <td>915,305.62</td>
                            <td>1,272,438.11</td>
                            <td>1,816,948.83</td>
                            <td>1,872,946.62</td>
                            <td style="color: #10b981; font-weight: 600;">3.08%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°</td>
                            <td>915,305.62</td>
                            <td>1,272,438.11</td>
                            <td>1,816,948.83</td>
                            <td>1,872,946.62</td>
                            <td style="color: #10b981;">3.08%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.15); font-weight: 700; color: #4c63d2;">
                            <td></td>
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                            <td>17,118,215.82</td>
                            <td>22,865,286.59</td>
                            <td>20,536,070.71</td>
                            <td>13,379,983.48</td>
                            <td style="color: #ef4444;">-34.85%</td>
                        </tr>
                    </tbody>
                </table>
            `;

            // Insert the detailed table after the first data table
            const firstDataTable = document.querySelector('.data-table');
            firstDataTable.parentNode.insertBefore(detailedTable, firstDataTable.nextSibling);
            
            // Hide other tables
            const otherTables = document.querySelectorAll('.data-table:not(:first-of-type):not(#detailed-revenue-rights-table)');
            otherTables.forEach(table => table.style.display = 'none');
            
            // Re-initialize chart
            updateRevenueRightsChart();
        }

        function updateOtherIncomeChart() {
            if (revenueChart) {
                revenueChart.destroy();
            }
            
            const ctx = document.getElementById('revenueChart').getContext('2d');
            revenueChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['2565', '2566', '2567', '2568'],
                    datasets: [
                        {
                            label: '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ COVID-19 (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [11.53, 4.37, 0.00, 0.00],
                            backgroundColor: '#ef4444',
                            borderColor: '#ef4444',
                            borderWidth: 1
                        },
                        {
                            label: '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏≠‡∏á (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [1.41, 1.47, 1.63, 1.57],
                            backgroundColor: '#4c63d2',
                            borderColor: '#4c63d2',
                            borderWidth: 1
                        },
                        {
                            label: '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [1.11, 1.08, 1.68, 1.72],
                            backgroundColor: '#10b981',
                            borderColor: '#10b981',
                            borderWidth: 1
                        },
                        {
                            label: '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [0.74, 0.71, 0.49, 0.84],
                            backgroundColor: '#f59e0b',
                            borderColor: '#f59e0b',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        }
                    },
                    onClick: (event, elements) => {
                        if (elements.length > 0) {
                            const element = elements[0];
                            const datasetIndex = element.datasetIndex;
                            const dataIndex = element.index;
                            
                            const dataset = revenueChart.data.datasets[datasetIndex];
                            const year = revenueChart.data.labels[dataIndex];
                            const datasetLabel = dataset.label;
                            
                            const fullAmount = otherIncomeDataMapping[datasetLabel][year];
                            
                            showDataPopup(datasetLabel, year, fullAmount);
                        }
                    }
                }
            });
        }

        function showOtherIncomeData() {
            // Hide filters for this section
            document.getElementById('filters-container').style.display = 'none';
            
            // Update metrics to show other income summary
            const metricsGrid = document.getElementById('metrics-grid');
            metricsGrid.innerHTML = `
                <div class="card">
                    <h3>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ COVID-19</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">11,528,384.22 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">4,369,070.43 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">0.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">0.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏≠‡∏á</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">1,411,446.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">1,466,069.50 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">1,630,536.75 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">1,566,850.25 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">1,108,073.92 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">1,084,676.49 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">1,676,757.70 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">1,718,537.01 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">741,500.32 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">709,948.59 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">494,061.20 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">842,660.07 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">14,789,404.46 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">7,629,765.01 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">3,801,355.65 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">4,128,047.33 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï</h3>
                    <div class="metric">
                        <span class="metric-label">2566 ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 2565</span>
                        <span class="metric-value" style="color: #ef4444;">-48.41%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">2567 ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 2566</span>
                        <span class="metric-value" style="color: #ef4444;">-50.18%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">2568 ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 2567</span>
                        <span class="metric-value" style="color: #10b981;">+8.59%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 4 ‡∏õ‡∏µ</span>
                        <span class="metric-value" style="color: #ef4444;">-30.00%</span>
                    </div>
                </div>
            `;

            // Update chart for other income
            updateOtherIncomeChart();
            
            // Show other income table
            showOtherIncomeTable();
        }

        function showOperatingIncomeData() {
            // Hide filters for this section
            document.getElementById('filters-container').style.display = 'none';
            
            // Update metrics to show operating income summary
            const metricsGrid = document.getElementById('metrics-grid');
            metricsGrid.innerHTML = `
                <div class="card">
                    <h3>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">31,907,620.28 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">30,495,051.60 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">24,337,426.36 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">17,508,030.81 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">535,010.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">1,423,500.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">632,001.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">178,875.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°/‡∏á‡∏ö‡∏•‡∏á‡∏ó‡∏∏‡∏ô</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">2,225,672.61 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">1,573,444.29 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">2,372,730.03 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">2,720,600.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>CF (UC IP + UC OP + UC PP)</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">1,050,027.98 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">4,407,450.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">2,657,128.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">500,000.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">78,420.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">2,055,000.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">1,150,000.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">2,934,000.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>

                <div class="card">
                    <h3>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ + CF</h3>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2565</span>
                        <span class="metric-value">33,036,068.26 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2566</span>
                        <span class="metric-value">36,957,501.60 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2567</span>
                        <span class="metric-value">28,144,554.36 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">‡∏õ‡∏µ 2568</span>
                        <span class="metric-value">20,942,030.81 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>
            `;

            // Update chart for operating income
            updateOperatingIncomeChart();
            
            // Show operating income table
            showOperatingIncomeTable();
        }

        function updateOperatingIncomeChart() {
            if (revenueChart) {
                revenueChart.destroy();
            }
            
            const ctx = document.getElementById('revenueChart').getContext('2d');
            revenueChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['2565', '2566', '2567', '2568'],
                    datasets: [
                        {
                            label: '‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [31.91, 30.50, 24.34, 17.51],
                            backgroundColor: '#4c63d2',
                            borderColor: '#4c63d2',
                            borderWidth: 1
                        },
                        {
                            label: 'CF (UC IP + UC OP + UC PP) (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [1.05, 4.41, 2.66, 0.50],
                            backgroundColor: '#10b981',
                            borderColor: '#10b981',
                            borderWidth: 1
                        },
                        {
                            label: '‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [0.08, 2.06, 1.15, 2.93],
                            backgroundColor: '#f59e0b',
                            borderColor: '#f59e0b',
                            borderWidth: 1
                        },
                        {
                            label: '‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ (‡∏•‡πâ‡∏≤‡∏ô‡∏ö‡∏≤‡∏ó)',
                            data: [0.54, 1.42, 0.63, 0.18],
                            backgroundColor: '#ef4444',
                            borderColor: '#ef4444',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    family: 'Prompt'
                                }
                            }
                        }
                    },
                    onClick: (event, elements) => {
                        if (elements.length > 0) {
                            const element = elements[0];
                            const datasetIndex = element.datasetIndex;
                            const dataIndex = element.index;
                            
                            const dataset = revenueChart.data.datasets[datasetIndex];
                            const year = revenueChart.data.labels[dataIndex];
                            const datasetLabel = dataset.label;
                            
                            const fullAmount = operatingIncomeDataMapping[datasetLabel][year];
                            
                            showDataPopup(datasetLabel, year, fullAmount);
                        }
                    }
                }
            });
        }

        function showOperatingIncomeTable() {
            // Replace existing tables with operating income table
            const chartContainer = document.querySelector('.chart-container');
            chartContainer.innerHTML = `
                <h3>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ 4 ‡∏õ‡∏µ</h3>
                <canvas id="revenueChart" width="400" height="200"></canvas>
            `;
            
            const dataTableContainer = document.querySelector('.data-table');
            dataTableContainer.innerHTML = `
                <h3>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
                <table>
                    <thead>
                        <tr>
                            <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 65</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 66</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 67</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 68</th>
                            <th>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ô‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: rgba(76, 99, 210, 0.15); font-weight: 700; color: #4c63d2;">
                            <td></td>
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</td>
                            <td>31,907,620.28</td>
                            <td>30,495,051.60</td>
                            <td>24,337,426.36</td>
                            <td>17,508,030.81</td>
                            <td style="color: #ef4444;">-28.06%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td></td>
                            <td style="font-weight: 600;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</td>
                            <td style="padding-left: 20px;">‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ</td>
                            <td>535,010.00</td>
                            <td>1,423,500.00</td>
                            <td>632,001.00</td>
                            <td>178,875.00</td>
                            <td style="color: #ef4444;">-71.69%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</td>
                            <td style="padding-left: 20px;">‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°/‡∏á‡∏ö‡∏•‡∏á‡∏ó‡∏∏‡∏ô</td>
                            <td>2,225,672.61</td>
                            <td>1,573,444.29</td>
                            <td>2,372,730.03</td>
                            <td>2,720,600.00</td>
                            <td style="color: #10b981;">+14.66%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</td>
                            <td style="padding-left: 20px;">CF (UC IP + UC OP + UC PP)</td>
                            <td>1,050,027.98</td>
                            <td>4,407,450.00</td>
                            <td>2,657,128.00</td>
                            <td>500,000.00</td>
                            <td style="color: #ef4444;">-81.18%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</td>
                            <td style="padding-left: 20px;">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô</td>
                            <td>78,420.00</td>
                            <td>2,055,000.00</td>
                            <td>1,150,000.00</td>
                            <td>2,934,000.00</td>
                            <td style="color: #10b981;">+155.13%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td></td>
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô (CF + ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô)</td>
                            <td>1,128,447.98</td>
                            <td>6,462,450.00</td>
                            <td>3,807,128.00</td>
                            <td>3,434,000.00</td>
                            <td style="color: #ef4444;">-9.80%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.15); font-weight: 700; color: #4c63d2;">
                            <td></td>
                            <td>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ + CF</td>
                            <td>33,036,068.26</td>
                            <td>36,957,501.60</td>
                            <td>28,144,554.36</td>
                            <td>20,942,030.81</td>
                            <td style="color: #ef4444;">-25.59%</td>
                        </tr>
                    </tbody>
                </table>
            `;

            // Add the detailed operating income table after the main table
            const mainContent = document.querySelector('.main-content');
            const existingDetailedTable = document.getElementById('detailed-operating-income-table');
            if (existingDetailedTable) {
                existingDetailedTable.remove();
            }

            const detailedTable = document.createElement('div');
            detailedTable.id = 'detailed-operating-income-table';
            detailedTable.className = 'data-table';
            detailedTable.style.marginTop = '20px';
            detailedTable.innerHTML = `
                <h3>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ - ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏° 4 ‡∏õ‡∏µ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 65</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 66</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 67</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 68</th>
                            <th>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</th>
                            <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: rgba(76, 99, 210, 0.15); font-weight: 700; color: #4c63d2;">
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</td>
                            <td>31,907,620.28</td>
                            <td>30,495,051.60</td>
                            <td>24,337,426.36</td>
                            <td>17,508,030.81</td>
                            <td style="color: #ef4444;">‚Üì -28.06%</td>
                            <td>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏Å</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td colspan="7" style="font-weight: 600; color: #4c63d2; text-align: center;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ</td>
                            <td>535,010.00</td>
                            <td>1,423,500.00</td>
                            <td>632,001.00</td>
                            <td>178,875.00</td>
                            <td style="color: #ef4444;">‚Üì -71.69%</td>
                            <td>‡∏ö‡∏£‡∏¥‡∏à‡∏≤‡∏Ñ‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°/‡∏á‡∏ö‡∏•‡∏á‡∏ó‡∏∏‡∏ô</td>
                            <td>2,225,672.61</td>
                            <td>1,573,444.29</td>
                            <td>2,372,730.03</td>
                            <td>2,720,600.00</td>
                            <td style="color: #10b981;">‚Üë +14.66%</td>
                            <td>‡∏á‡∏ö‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏£‡∏±‡∏ê</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">CF (UC IP + UC OP + UC PP)</td>
                            <td>1,050,027.98</td>
                            <td>4,407,450.00</td>
                            <td>2,657,128.00</td>
                            <td>500,000.00</td>
                            <td style="color: #ef4444;">‚Üì -81.18%</td>
                            <td>‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô UC</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô</td>
                            <td>78,420.00</td>
                            <td>2,055,000.00</td>
                            <td>1,150,000.00</td>
                            <td>2,934,000.00</td>
                            <td style="color: #10b981;">‚Üë +155.13%</td>
                            <td>‡∏£‡∏û.‡∏û‡∏´‡∏•‡∏Ø, ‡∏£‡∏û.‡∏°‡∏∞‡∏Å‡∏≤‡∏£‡∏±‡∏Å‡∏©‡πå, ‡∏£‡∏û.‡∏ó‡∏≠‡∏á‡∏ú‡∏≤‡∏†‡∏π‡∏°‡∏¥</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô (CF + ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô)</td>
                            <td>1,128,447.98</td>
                            <td>6,462,450.00</td>
                            <td>3,807,128.00</td>
                            <td>3,434,000.00</td>
                            <td style="color: #ef4444;">‚Üì -9.80%</td>
                            <td>-</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.15); font-weight: 700; color: #4c63d2;">
                            <td>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ + CF</td>
                            <td>33,036,068.26</td>
                            <td>36,957,501.60</td>
                            <td>28,144,554.36</td>
                            <td>20,942,030.81</td>
                            <td style="color: #ef4444;">‚Üì -25.59%</td>
                            <td>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td colspan="7" style="font-weight: 600; color: #4c63d2; text-align: center;">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 40px; font-size: 14px;">‡∏õ‡∏µ 2566: ‡∏£‡∏û.‡∏û‡∏´‡∏•‡∏Ø ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô</td>
                            <td>-</td>
                            <td>2,000,000</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏ï‡∏≠‡∏ô‡∏õ‡∏µ 66</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 40px; font-size: 14px;">‡∏õ‡∏µ 2567: ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏£‡∏û.‡∏°‡∏∞‡∏Å‡∏≤‡∏£‡∏±‡∏Å‡∏©‡πå</td>
                            <td>-</td>
                            <td>-</td>
                            <td>1,000,000</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 40px; font-size: 14px;">‡∏õ‡∏µ 2567: ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏∏‡∏®‡∏•</td>
                            <td>-</td>
                            <td>-</td>
                            <td>150,000</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 40px; font-size: 14px;">‡∏õ‡∏µ 2568: ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏£‡∏û.‡πÑ‡∏ó‡∏£‡πÇ‡∏¢‡∏Ñ</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>500,000</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 40px; font-size: 14px;">‡∏õ‡∏µ 2568: ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏£‡∏û.‡πÄ‡∏•‡∏≤‡∏Ç‡∏ß‡∏±‡∏ç</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>500,000</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 40px; font-size: 14px;">‡∏õ‡∏µ 2568: ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏£‡∏û.‡∏ó‡∏≠‡∏á‡∏ú‡∏≤‡∏†‡∏π‡∏°‡∏¥</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>1,934,000</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                    </tbody>
                </table>
            `;

            // Insert the detailed table after the first data table
            const firstDataTable = document.querySelector('.data-table');
            firstDataTable.parentNode.insertBefore(detailedTable, firstDataTable.nextSibling);
            
            // Hide other tables
            const otherTables = document.querySelectorAll('.data-table:not(:first-of-type):not(#detailed-operating-income-table)');
            otherTables.forEach(table => table.style.display = 'none');
            
            // Re-initialize chart
            updateOperatingIncomeChart();
        }

        function showOtherIncomeTable() {
            // Replace existing tables with other income table
            const chartContainer = document.querySelector('.chart-container');
            chartContainer.innerHTML = `
                <h3>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ 4 ‡∏õ‡∏µ</h3>
                <canvas id="revenueChart" width="400" height="200"></canvas>
            `;
            
            const dataTableContainer = document.querySelector('.data-table');
            dataTableContainer.innerHTML = `
                <h3>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 65</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 66</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 67</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 68</th>
                            <th>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ô‡∏õ‡∏µ‡∏Å‡πà‡∏≠‡∏ô</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td></td>
                            <td style="font-weight: 600;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÇ‡∏£‡∏Ñ‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™‡πÇ‡∏Ñ‡πÇ‡∏£‡∏ô‡πà‡∏≤ (‡∏™‡∏õ‡∏™‡∏ä.)</td>
                            <td>10,939,264.62</td>
                            <td>3,463,394.43</td>
                            <td>-</td>
                            <td>-</td>
                            <td style="color: #ef4444;">-68.34%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÇ‡∏£‡∏Ñ‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™‡πÇ‡∏Ñ‡πÇ‡∏£‡∏ô‡πà‡∏≤ (‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°)</td>
                            <td>589,119.60</td>
                            <td>905,676.00</td>
                            <td>-</td>
                            <td>-</td>
                            <td style="color: #10b981;">+53.73%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ (OP‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏£‡∏ß‡∏á)</td>
                            <td>596,607.26</td>
                            <td>307,672.72</td>
                            <td>66,446.04</td>
                            <td>536,071.34</td>
                            <td style="color: #10b981;">+706.78%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏≠‡∏á</td>
                            <td>1,411,446.00</td>
                            <td>1,466,069.50</td>
                            <td>1,630,536.75</td>
                            <td>1,566,850.25</td>
                            <td style="color: #ef4444;">-3.91%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏û‡∏£‡∏ö.‡∏£‡∏ñ</td>
                            <td>60,949.00</td>
                            <td>225,348.00</td>
                            <td>259,003.00</td>
                            <td>129,792.00</td>
                            <td style="color: #ef4444;">-49.89%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ : ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û+‡∏ï‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ß +‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ôIp</td>
                            <td>1,108,073.92</td>
                            <td>1,084,676.49</td>
                            <td>1,676,757.70</td>
                            <td>1,718,537.01</td>
                            <td style="color: #10b981;">+2.49%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td style="padding-left: 20px;">‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</td>
                            <td>40,444.06</td>
                            <td>50,315.87</td>
                            <td>74,637.16</td>
                            <td>47,456.73</td>
                            <td style="color: #ef4444;">-36.42%</td>
                        </tr>
                        <tr>
                            <td style="text-align: center; font-weight: 600; color: #4c63d2;">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td style="padding-left: 20px;">‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ï‡∏≥‡∏ö‡∏•</td>
                            <td>43,500.00</td>
                            <td>126,612.00</td>
                            <td>93,975.00</td>
                            <td>129,340.00</td>
                            <td style="color: #10b981;">+37.65%</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.15); font-weight: 700; color: #4c63d2;">
                            <td></td>
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td>14,789,404.46</td>
                            <td>7,629,765.01</td>
                            <td>3,801,355.65</td>
                            <td>4,128,047.33</td>
                            <td style="color: #10b981;">+8.59%</td>
                        </tr>
                    </tbody>
                </table>
            `;

            // Add the detailed other income table after the main table
            const mainContent = document.querySelector('.main-content');
            const existingDetailedTable = document.getElementById('detailed-other-income-table');
            if (existingDetailedTable) {
                existingDetailedTable.remove();
            }

            const detailedTable = document.createElement('div');
            detailedTable.id = 'detailed-other-income-table';
            detailedTable.className = 'data-table';
            detailedTable.style.marginTop = '20px';
            detailedTable.innerHTML = `
                <h3>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ - ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏° 4 ‡∏õ‡∏µ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 65</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 66</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 67</th>
                            <th>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏õ‡∏µ 68</th>
                            <th>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°</th>
                            <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td colspan="7" style="font-weight: 600; color: #4c63d2; text-align: center;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ COVID-19</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÇ‡∏£‡∏Ñ‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™‡πÇ‡∏Ñ‡πÇ‡∏£‡∏ô‡πà‡∏≤ (‡∏™‡∏õ‡∏™‡∏ä.)</td>
                            <td>10,939,264.62</td>
                            <td>3,463,394.43</td>
                            <td>-</td>
                            <td>-</td>
                            <td style="color: #ef4444;">‚Üì -68.34%</td>
                            <td>‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÇ‡∏£‡∏Ñ‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™‡πÇ‡∏Ñ‡πÇ‡∏£‡∏ô‡πà‡∏≤ (‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏á‡∏Ñ‡∏°)</td>
                            <td>589,119.60</td>
                            <td>905,676.00</td>
                            <td>-</td>
                            <td>-</td>
                            <td style="color: #10b981;">‚Üë +53.73%</td>
                            <td>‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ COVID-19</td>
                            <td>11,528,384.22</td>
                            <td>4,369,070.43</td>
                            <td>0.00</td>
                            <td>0.00</td>
                            <td style="color: #ef4444;">‚Üì -62.11%</td>
                            <td>-</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td colspan="7" style="font-weight: 600; color: #4c63d2; text-align: center;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏≠‡∏á</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏≠‡∏á</td>
                            <td>1,411,446.00</td>
                            <td>1,466,069.50</td>
                            <td>1,630,536.75</td>
                            <td>1,566,850.25</td>
                            <td style="color: #ef4444;">‚Üì -3.91%</td>
                            <td>‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏≠‡∏á</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td colspan="7" style="font-weight: 600; color: #4c63d2; text-align: center;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ (OP‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏£‡∏ß‡∏á)</td>
                            <td>596,607.26</td>
                            <td>307,672.72</td>
                            <td>66,446.04</td>
                            <td>536,071.34</td>
                            <td style="color: #10b981;">‚Üë +706.78%</td>
                            <td>‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‡∏û‡∏£‡∏ö.‡∏£‡∏ñ</td>
                            <td>60,949.00</td>
                            <td>225,348.00</td>
                            <td>259,003.00</td>
                            <td>129,792.00</td>
                            <td style="color: #ef4444;">‚Üì -49.89%</td>
                            <td>‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡∏à‡∏£‡∏≤‡∏à‡∏£</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ : ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û+‡∏ï‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ß +‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ôIp</td>
                            <td>1,108,073.92</td>
                            <td>1,084,676.49</td>
                            <td>1,676,757.70</td>
                            <td>1,718,537.01</td>
                            <td style="color: #10b981;">‚Üë +2.49%</td>
                            <td>‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td>1,765,630.18</td>
                            <td>1,617,697.21</td>
                            <td>2,002,206.74</td>
                            <td>2,384,400.35</td>
                            <td style="color: #10b981;">‚Üë +19.08%</td>
                            <td>-</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.05);">
                            <td colspan="7" style="font-weight: 600; color: #4c63d2; text-align: center;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</td>
                            <td>40,444.06</td>
                            <td>50,315.87</td>
                            <td>74,637.16</td>
                            <td>47,456.73</td>
                            <td style="color: #ef4444;">‚Üì -36.42%</td>
                            <td>‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</td>
                        </tr>
                        <tr>
                            <td style="padding-left: 20px;">‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ï‡∏≥‡∏ö‡∏•</td>
                            <td>43,500.00</td>
                            <td>126,612.00</td>
                            <td>93,975.00</td>
                            <td>129,340.00</td>
                            <td style="color: #10b981;">‚Üë +37.65%</td>
                            <td>‡∏Å‡∏≠‡∏á‡∏ó‡∏∏‡∏ô‡∏ï‡∏≥‡∏ö‡∏•</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ</td>
                            <td>83,944.06</td>
                            <td>176,927.87</td>
                            <td>168,612.16</td>
                            <td>176,796.73</td>
                            <td style="color: #10b981;">‚Üë +4.85%</td>
                            <td>-</td>
                        </tr>
                        <tr style="background: rgba(76, 99, 210, 0.15); font-weight: 700; color: #4c63d2;">
                            <td>‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                            <td>14,789,404.46</td>
                            <td>7,629,765.01</td>
                            <td>3,801,355.65</td>
                            <td>4,128,047.33</td>
                            <td style="color: #10b981;">‚Üë +8.59%</td>
                            <td>-</td>
                        </tr>
                    </tbody>
                </table>
            `;

            // Insert the detailed table after the first data table
            const firstDataTable = document.querySelector('.data-table');
            firstDataTable.parentNode.insertBefore(detailedTable, firstDataTable.nextSibling);
            
            // Hide other tables
            const otherTables = document.querySelectorAll('.data-table:not(:first-of-type):not(#detailed-other-income-table)');
            otherTables.forEach(table => table.style.display = 'none');
            
            // Re-initialize chart
            updateOtherIncomeChart();
        }

        function updateDetailTables(year) {
            if (year === 'all') {
                // Show data for latest year (2568) when "all" is selected
                updateReceivablesTable('2568');
                updateDebtTable('2568');
            } else {
                // Show data for selected year
                updateReceivablesTable(year);
                updateDebtTable(year);
            }
        }

        function updateReceivablesTable(year) {
            const data = yearlyData[year];
            if (!data || !data.receivables_detail) return;

            const receivablesTableContainer = document.querySelector('.data-table:nth-of-type(3)');
            if (!receivablesTableContainer) return;

            const totalReceivables = data.receivables;
            
            receivablesTableContainer.innerHTML = `
                <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥ (‡∏õ‡∏µ ${year})</h3>
                <table>
                    <thead>
                        <tr>
                            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ</th>
                            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</th>
                            <th>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (%)</th>
                            <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${Object.entries(data.receivables_detail).map(([type, info]) => `
                            <tr>
                                <td>${type}</td>
                                <td>${info.amount.toLocaleString('th-TH', { minimumFractionDigits: 2 })}</td>
                                <td style="color: #4c63d2; font-weight: 600;">${info.percent.toFixed(2)}%</td>
                                <td>${type.includes('‡∏ô‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î') ? '‡∏ô‡∏≠‡∏Å‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î' : '-'}</td>
                            </tr>
                        `).join('')}
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td>‡∏£‡∏ß‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                            <td>${totalReceivables.toLocaleString('th-TH', { minimumFractionDigits: 2 })}</td>
                            <td style="color: #4c63d2;">100.00%</td>
                            <td>-</td>
                        </tr>
                    </tbody>
                </table>
            `;
        }

        function updateDebtTable(year) {
            const data = yearlyData[year];
            if (!data || !data.debt_detail) return;

            const debtTableContainer = document.querySelector('.data-table:nth-of-type(4)');
            if (!debtTableContainer) return;

            const totalDebt = data.debt;
            
            debtTableContainer.innerHTML = `
                <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏∞‡∏™‡∏° (‡∏õ‡∏µ ${year})</h3>
                <table>
                    <thead>
                        <tr>
                            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ</th>
                            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</th>
                            <th>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (%)</th>
                            <th>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${Object.entries(data.debt_detail).map(([type, info]) => `
                            <tr>
                                <td>${type}</td>
                                <td>${info.amount.toLocaleString('th-TH', { minimumFractionDigits: 2 })}</td>
                                <td style="color: #4c63d2; font-weight: 600;">${info.percent.toFixed(2)}%</td>
                                <td>${getDebtCategory(type)}</td>
                            </tr>
                        `).join('')}
                        <tr style="background: rgba(76, 99, 210, 0.1); font-weight: 600;">
                            <td>‡∏£‡∏ß‡∏°‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                            <td>${totalDebt.toLocaleString('th-TH', { minimumFractionDigits: 2 })}</td>
                            <td style="color: #4c63d2;">100.00%</td>
                            <td>-</td>
                        </tr>
                    </tbody>
                </table>
            `;
        }

        function getDebtCategory(type) {
            const categories = {
                '‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô': '‡∏Ñ‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô',
                '‡∏¢‡∏≤': '‡∏¢‡∏≤',
                '‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏ò.': '‡∏ô‡∏Ñ 1',
                '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå': 'lab + ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå',
                '‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå': 'lab + ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå',
                '‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏™‡∏±‡∏ç‡∏ç‡∏≤': '‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏ù‡∏≤‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
                '‡∏†‡∏≤‡∏©‡∏µ‡∏´‡∏±‡∏Å ‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢': '‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏±‡∏ö‡∏ù‡∏≤‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ'
            };
            return categories[type] || '‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏≠‡∏∑‡πà‡∏ô';
        }

        function updateTableData(year, department, rights) {
            // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡πÄ‡∏™‡∏°‡∏≠
            // ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡πÉ‡∏ô‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå
            // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
        }

        function updateMetrics(year) {
            const metricsGrid = document.getElementById('metrics-grid');
            
            if (year === 'all') {
                // Show all years data in comparison format
                metricsGrid.innerHTML = `
                    <div class="card">
                        <h3>‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2565</span>
                            <span class="metric-value">9,866,449.65 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2566</span>
                            <span class="metric-value">12,128,216.38 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2567</span>
                            <span class="metric-value">11,202,559.81 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2568</span>
                            <span class="metric-value">5,621,160.91 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏∞‡∏™‡∏° (‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2565</span>
                            <span class="metric-value">1,883,518.87 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2566</span>
                            <span class="metric-value">4,335,839.68 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2567</span>
                            <span class="metric-value">10,500,593.50 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2568</span>
                            <span class="metric-value">10,759,203.62 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2565</span>
                            <span class="metric-value">4,148,801.36 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2566</span>
                            <span class="metric-value">5,046,204.04 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2567</span>
                            <span class="metric-value">4,747,463.01 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2568</span>
                            <span class="metric-value">6,199,498.52 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô (NET INCOME)</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2565</span>
                            <span class="metric-value" style="color: #ef4444;">-1,334,337.12 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2566</span>
                            <span class="metric-value" style="color: #ef4444;">-568,838.75 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2567</span>
                            <span class="metric-value" style="color: #10b981;">3,654,100.98 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2568</span>
                            <span class="metric-value" style="color: #ef4444;">-1,313,807.82 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Current Ratio)</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2565</span>
                            <span class="metric-value">3.14</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2566</span>
                            <span class="metric-value">3.50</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2567</span>
                            <span class="metric-value">4.84</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2568</span>
                            <span class="metric-value">2.79</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>Working Capital</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2565</span>
                            <span class="metric-value">8,878,634.38 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2566</span>
                            <span class="metric-value">12,614,806.17 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2567</span>
                            <span class="metric-value">18,212,923.60 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ 2568</span>
                            <span class="metric-value">11,123,611.54 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>
                `;
            } else {
                // Show single year data
                const data = yearlyData[year];
                
                if (!data) return;
                
                metricsGrid.innerHTML = `
                    <div class="card">
                        <h3>‡πÄ‡∏á‡∏¥‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ ${year}</span>
                            <span class="metric-value">${data.maintenance_fund.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏∞‡∏™‡∏° (‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•)</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ ${year}</span>
                            <span class="metric-value">${data.receivables.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‡∏†‡∏≤‡∏£‡∏∞‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ ${year}</span>
                            <span class="metric-value">${data.debt.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô (NET INCOME)</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ ${year}</span>
                            <span class="metric-value" style="color: ${data.net_income >= 0 ? '#10b981' : '#ef4444'};">${data.net_income >= 0 ? '' : '-'}${Math.abs(data.net_income).toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (‡∏õ‡∏µ ${year})</h3>
                        <div class="metric">
                            <span class="metric-label">Current Ratio</span>
                            <span class="metric-value">${data.current_ratio}</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Quick Ratio</span>
                            <span class="metric-value">${data.quick_ratio}</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Cash Ratio</span>
                            <span class="metric-value">${data.cash_ratio}</span>
                        </div>
                    </div>

                    <div class="card">
                        <h3>Working Capital</h3>
                        <div class="metric">
                            <span class="metric-label">‡∏õ‡∏µ ${year}</span>
                            <span class="metric-value">${data.working_capital.toLocaleString()} ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                    </div>
                `;
            }
        }

        // Element SDK implementation
        async function onConfigChange(config) {
            const hospitalName = config.hospital_name || defaultConfig.hospital_name;
            const dashboardTitle = config.dashboard_title || defaultConfig.dashboard_title;
            
            document.getElementById('hospital-name').textContent = hospitalName;
            document.getElementById('dashboard-title').textContent = dashboardTitle;
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.primary_color || defaultConfig.primary_color,
                        set: (value) => {
                            config.primary_color = value;
                            window.elementSdk.setConfig({ primary_color: value });
                        }
                    },
                    {
                        get: () => config.secondary_color || defaultConfig.secondary_color,
                        set: (value) => {
                            config.secondary_color = value;
                            window.elementSdk.setConfig({ secondary_color: value });
                        }
                    },
                    {
                        get: () => config.background_color || defaultConfig.background_color,
                        set: (value) => {
                            config.background_color = value;
                            window.elementSdk.setConfig({ background_color: value });
                        }
                    },
                    {
                        get: () => config.text_color || defaultConfig.text_color,
                        set: (value) => {
                            config.text_color = value;
                            window.elementSdk.setConfig({ text_color: value });
                        }
                    },
                    {
                        get: () => config.accent_color || defaultConfig.accent_color,
                        set: (value) => {
                            config.accent_color = value;
                            window.elementSdk.setConfig({ accent_color: value });
                        }
                    }
                ],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["hospital_name", config.hospital_name || defaultConfig.hospital_name],
                ["dashboard_title", config.dashboard_title || defaultConfig.dashboard_title]
            ]);
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize first menu as active
            document.getElementById('overview-menu').classList.add('active');
            document.getElementById('overview-arrow').classList.add('rotated');
            document.querySelector('.menu-header').classList.add('active');
            
            // Initialize chart
            initChart();
            
            // Initialize Element SDK
            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    onConfigChange,
                    mapToCapabilities,
                    mapToEditPanelValues
                });
            }
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'998107b2024e7323',t:'MTc2MjA1OTIyNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

